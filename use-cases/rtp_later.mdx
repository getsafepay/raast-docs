---
title: 'Create Request To Pay (later)'
description: 'Schedule an RTP_LATER payment that gives the customer more time to approve.'
---

Use this flow when customers may approve hours or days after you submit the payment—for example, invoice settlements or subscription renewals.

## Flow summary

1. Load the `aggregator_merchant_identifier` for the merchant initiating the payment.
2. Choose an expiry window between 1 and 40 days.
3. Submit `POST /v1/aggregators/{{aggregator_id}}/payments` with `type: RTP_LATER`.
4. Wait for the webhook event or poll the status endpoint to confirm settlement.

## RTP later

<Tabs>
  <Tab title="Request Fields">

<ParamField path="request_id" type="string" required>
  UUID that keeps the scheduled Request To Pay idempotent.
</ParamField>
<ParamField path="amount" type="integer" required>
  Amount in paisa. `22000` equals PKR 220.00.
</ParamField>
<ParamField path="aggregator_merchant_identifier" type="string" required>
  Token returned when you created the merchant.
</ParamField>
<ParamField path="order_id" type="string" required>
  Merchant order reference used for reconciliation.
</ParamField>
<ParamField path="type" type="string" required>
  Set to `RTP_LATER`.
</ParamField>
<ParamField path="expiry_in_days" type="integer" required>
  Approval window in days (1–40).
</ParamField>
<ParamField path="debitor_raast_id" type="string">
  Provide when requesting via a Raast alias. One of the debtor identifiers must be supplied.
</ParamField>
<ParamField path="debitor_iban" type="string">
  Use when you know the debtor’s IBAN instead of a Raast ID. One of the debtor identifiers must be supplied.
</ParamField>
<ParamField path="debitor_vault_token" type="string">
  Reference a stored payment method for recurring requests. One of the debtor identifiers must be supplied.
</ParamField>

  </Tab>
  <Tab title="API Example">

<CodeGroup>

```bash cURL
curl --request POST "{{base_url}}/v1/aggregators/{{aggregator_id}}/payments" \
  --header "X-SFPY-AGGREGATOR-SECRET-KEY: {{secret_key}}" \
  --header "Content-Type: application/json" \
  --data '{
    "request_id": "{{request_id}}",
    "amount": 22000,
    "aggregator_merchant_identifier": "{{aggregator_merchant_identifier}}",
    "order_id": "ORDER-INVOICE-2025-07",
    "type": "RTP_LATER",
    "expiry_in_days": 7,
    "debitor_raast_id": "03202296111"
  }'
```

```typescript TypeScript
const aggregatorMerchantIdentifier = process.env.SAFEPAY_AGGREGATOR_MERCHANT_IDENTIFIER;
if (!aggregatorMerchantIdentifier) {
  throw new Error('Missing SAFEPAY_AGGREGATOR_MERCHANT_IDENTIFIER');
}

const rtpLaterResponse = await fetch(
  `${process.env.SAFEPAY_BASE_URL}/v1/aggregators/${process.env.SAFEPAY_AGGREGATOR_ID}/payments`,
  {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-SFPY-AGGREGATOR-SECRET-KEY': process.env.SAFEPAY_SECRET_KEY ?? '',
    },
    body: JSON.stringify({
      request_id: crypto.randomUUID(),
      amount: 22000,
      aggregator_merchant_identifier: aggregatorMerchantIdentifier,
      order_id: 'ORDER-INVOICE-2025-07',
      type: 'RTP_LATER',
      expiry_in_days: 7,
      debitor_raast_id: '03202296111',
    }),
  },
);

if (!rtpLaterResponse.ok) {
  const errorPayload = await rtpLaterResponse.json();
  throw new Error(`RTP later failed: ${rtpLaterResponse.status} ${errorPayload.message}`);
}

type CreatePaymentPayload = {
  api_version: string;
  data: {
    token: string;
    status: 'P_INITIATED' | 'P_RECEIVED' | 'P_FAILED' | 'P_REJECTED' | 'P_SETTLED';
    request_id: string;
    order_id: string;
    trace_reference?: string;
    msg_id?: string;
    created_at: string;
  };
};

const rtpLaterPayload: CreatePaymentPayload = await rtpLaterResponse.json();
console.log('Scheduled RTP token', rtpLaterPayload.data.token);
```

</CodeGroup>

  </Tab>
  <Tab title="Sample Response">

```json
{
  "api_version": "v1",
  "data": {
    "message": "RTP created successfully",
    "token": "pm_f531c5eb-5c49-40d6-8ac5-012cfd1b24c1",
    "msg_id": "IG2Y50ORB7BE2OLEW0HDVJUIP9QGTL1V6WS",
    "trace_reference": "aa22cc9b-3f55-4613-86cf-9641f11902d1",
    "uetr": "8df9cc1f-77b2-47e4-9a8b-a3050bee6972",
    "status": "P_INITIATED",
    "order_id": "ORDER-INVOICE-2025-07",
    "request_id": "{{request_id}}",
    "created_at": "2025-06-26T10:58:17Z"
  }
}
```

  </Tab>
</Tabs>

## Monitor status

```bash
curl --request GET "{{base_url}}/v1/aggregators/{{aggregator_id}}/payments/{{payment_token}}" \
  --header "X-SFPY-AGGREGATOR-SECRET-KEY: {{secret_key}}"
```

When the webhook indicates `P_SETTLED`, mark the invoice paid. If the customer rejects, resend with a new `request_id` after you resolve the issue.
